services:
  - type: web
    name: spana-backend
    env: node
    plan: free
    buildCommand: npm install && npm run build
    startCommand: node dist/server.js
    # IMPORTANT: Make sure buildCommand runs BEFORE startCommand
    # Build compiles TypeScript to dist/ folder
    envVars:
      - key: NODE_ENV
        value: production
      # DATABASE_URL must be set in Render Dashboard as an environment variable
      # DO NOT put the actual password here - set it in Render Dashboard instead
      # Use Internal Database URL for Render services (faster, no SSL needed)
      # Format: postgresql://spana_users:[ACTUAL-PASSWORD]@dpg-d3p2ooc9c44c738ksb8g-a/spana_db
      # For local development, use External URL with SSL: postgresql://spana_users:[ACTUAL-PASSWORD]@dpg-d3p2ooc9c44c738ksb8g-a.frankfurt-postgres.render.com/spana_db?sslmode=require
      - key: POSTGRES_SSL
        value: "false"
      - key: JWT_SECRET
        generateValue: true
      - key: CLIENT_URL
        value: https://your-frontend-domain.com
      - key: NODE_OPTIONS
        value: --max-old-space-size=4096
